{
  "$schema" : "https://json-schema.org/draft/2020-12/schema",
  "$id" : "https://github.com/ocaml/schema/toplevel.schema.json",
  "$defs" :
    {
      "box_type" :
        {
          "oneOf" :
            [{ "const" : "B"}, { "const" : "HoV"}, { "const" : "HV"},
              { "const" : "V"}, { "const" : "H"}]
        },
      "compiler" :
        {
          "type" : "object",
          "properties" :
            {
              "alerts" :
                {
                  "type" : "array",
                  "items" : { "$ref" : "#/$defs/error_report"}
                },
              "warnings" :
                {
                  "type" : "array",
                  "items" : { "$ref" : "#/$defs/error_report"}
                },
              "error" : { "$ref" : "#/$defs/error_report"},
              "debug" : { "$ref" : "#/$defs/debug"}
            },
          "required" : []
        },
      "debug" :
        {
          "type" : "object",
          "properties" :
            {
              "profile" : { "type" : "string"},
              "cmm_invariant" : { "type" : "string"},
              "linear" : { "type" : "array", "items" : { "type" : "string"}},
              "mach" : { "type" : "array", "items" : { "type" : "string"}},
              "unbox-specialised-args" :
                { "type" : "array", "items" : { "type" : "string"}},
              "unbox-closures" :
                { "type" : "array", "items" : { "type" : "string"}},
              "unbox-free-vars-of-closures" :
                { "type" : "array", "items" : { "type" : "string"}},
              "remove-free-vars-equal-to-args" :
                { "type" : "array", "items" : { "type" : "string"}},
              "cmm" : { "type" : "array", "items" : { "type" : "string"}},
              "raw_clambda" :
                { "type" : "array", "items" : { "type" : "string"}},
              "clambda" : { "type" : "array", "items" : { "type" : "string"}},
              "raw_flambda" :
                { "type" : "array", "items" : { "type" : "string"}},
              "flambda" : { "type" : "array", "items" : { "type" : "string"}},
              "raw_lambda" : { "type" : "string"},
              "lambda" : { "type" : "string"},
              "instr" : { "type" : "string"},
              "shape" : { "type" : "string"},
              "typedtree" : { "type" : "string"},
              "source" : { "type" : "string"},
              "parsetree" : { "type" : "string"}
            },
          "required" : []
        },
      "error_kind" :
        {
          "oneOf" :
            [{
               "type" : "array",
               "prefixItems" :
                 [{ "const" : "Report_warning_as_error"},
                   { "type" : "string"}]
             },
              {
                "type" : "array",
                "prefixItems" :
                  [{ "const" : "Report_warning"}, { "type" : "string"}]
              },
              {
                "type" : "array",
                "prefixItems" :
                  [{ "const" : "Report_alert_as_error"},
                    { "type" : "string"}]
              },
              {
                "type" : "array",
                "prefixItems" :
                  [{ "const" : "Report_alert"}, { "type" : "string"}]
              }, { "const" : "Report_error"}]
        },
      "error_msg" :
        {
          "type" : "object",
          "properties" :
            {
              "loc" : { "$ref" : "#/$defs/loc"},
              "msg" :
                {
                  "type" : "array",
                  "items" : { "$ref" : "#/$defs/structured_text"}
                }
            },
          "required" : ["msg"]
        },
      "error_report" :
        {
          "type" : "object",
          "properties" :
            {
              "footnote" :
                {
                  "type" : "array",
                  "items" : { "$ref" : "#/$defs/structured_text"}
                },
              "sub" :
                {
                  "type" : "array",
                  "items" : { "$ref" : "#/$defs/error_msg"}
                },
              "main" : { "$ref" : "#/$defs/error_msg"},
              "kind" : { "$ref" : "#/$defs/error_kind"}
            },
          "required" : ["main", "kind"]
        },
      "format_tag" :
        {
          "oneOf" :
            [{ "const" : "Preservation"}, { "const" : "Modification"},
              { "const" : "Insertion"}, { "const" : "Deletion"},
              { "const" : "Hint"}, { "const" : "Inline_code"},
              { "const" : "Loc"}, { "const" : "Warning"},
              { "const" : "Error"},
              {
                "type" : "array",
                "prefixItems" :
                  [{ "const" : "String_tag"}, { "type" : "string"}]
              },
              {
                "type" : "array",
                "prefixItems" :
                  [{ "const" : "<Unknown>"}, { "type" : "string"}]
              }]
        },
      "loc" :
        {
          "type" : "object",
          "properties" :
            {
              "characters" :
                {
                  "type" : "array",
                  "prefixItems" :
                    [{ "type" : "integer"}, { "type" : "integer"}]
                },
              "stop_line" : { "type" : "integer"},
              "start_line" : { "type" : "integer"},
              "file" : { "type" : "string"}
            },
          "required" : []
        },
      "metadata" :
        {
          "type" : "object",
          "properties" :
            {
              "deprecated_paths" :
                {
                  "type" : "array",
                  "items" :
                    { "type" : "array", "items" : { "type" : "string"}}
                },
              "invalid_paths" :
                {
                  "type" : "array",
                  "items" :
                    { "type" : "array", "items" : { "type" : "string"}}
                },
              "valid" : { "$ref" : "#/$defs/validity"},
              "version" :
                {
                  "type" : "array",
                  "prefixItems" :
                    [{ "type" : "integer"}, { "type" : "integer"}]
                }
            },
          "required" : ["valid", "version"]
        },
      "structured_text" :
        {
          "oneOf" :
            [{
               "type" : "array",
               "prefixItems" :
                 [{ "const" : "Tbox"},
                   {
                     "type" : "array",
                     "items" : { "$ref" : "#/$defs/structured_text"}
                   }]
             },
              {
                "type" : "array",
                "prefixItems" :
                  [{ "const" : "Tag"}, { "$ref" : "#/$defs/format_tag"},
                    {
                      "type" : "array",
                      "items" : { "$ref" : "#/$defs/structured_text"}
                    }]
              },
              {
                "type" : "array",
                "prefixItems" :
                  [{ "const" : "Box"}, { "$ref" : "#/$defs/box_type"},
                    { "type" : "integer"},
                    {
                      "type" : "array",
                      "items" : { "$ref" : "#/$defs/structured_text"}
                    }]
              },
              {
                "type" : "array",
                "prefixItems" :
                  [{ "const" : "With_size"}, { "type" : "integer"},
                    { "$ref" : "#/$defs/structured_text"}]
              }, { "const" : "<deprecated>"}, { "const" : "If_newline"},
              { "const" : "Newline"},
              {
                "type" : "array",
                "prefixItems" : [{ "const" : "Flush"}, { "type" : "boolean"}]
              },
              {
                "type" : "array",
                "prefixItems" :
                  [{ "const" : "Break"},
                    {
                      "type" : "array",
                      "prefixItems" :
                        [{ "type" : "string"}, { "type" : "integer"},
                          { "type" : "string"}]
                    },
                    {
                      "type" : "array",
                      "prefixItems" :
                        [{ "type" : "string"}, { "type" : "integer"},
                          { "type" : "string"}]
                    }]
              },
              {
                "type" : "array",
                "prefixItems" :
                  [{ "const" : "Simple_break"}, { "type" : "integer"},
                    { "type" : "integer"}]
              }, { "const" : "Set_tab"},
              {
                "type" : "array",
                "prefixItems" :
                  [{ "const" : "Tab_break"}, { "type" : "integer"},
                    { "type" : "integer"}]
              },
              {
                "type" : "array",
                "prefixItems" : [{ "const" : "Text"}, { "type" : "string"}]
              }]
        },
      "validity" :
        {
          "oneOf" :
            [{ "const" : "Invalid"}, { "const" : "Deprecated"},
              { "const" : "Full"}]
        }
    },
  "schema" : { "type" : "object"},
  "type" : "object",
  "properties" :
    {
      "metadata" : { "$ref" : "#/$defs/metadata"},
      "trace" :
        {
          "type" : "array",
          "items" :
            {
              "type" : "array",
              "items" : { "$ref" : "#/$defs/structured_text"}
            }
        },
      "errors" :
        {
          "type" : "array",
          "items" :
            {
              "type" : "array",
              "items" : { "$ref" : "#/$defs/structured_text"}
            }
        },
      "compiler_log" : { "$ref" : "#/$defs/compiler"},
      "backtrace" :
        { "type" : "array", "items" : { "$ref" : "#/$defs/structured_text"}},
      "output" :
        { "type" : "array", "items" : { "$ref" : "#/$defs/structured_text"}}
    },
  "required" : ["metadata"]
}
